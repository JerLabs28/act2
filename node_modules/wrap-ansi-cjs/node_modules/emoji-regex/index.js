reAddAccountRequested("aad");break;case 2:default:e.account().fireAddAccountRequested("msa")}},switchTo:function(n){var r=t(n.nextAccount),o=i[r].webaccountid;e.account().fireAccountSelectedRequested(o,n.nextAccount.type)},getRememberedAccounts:function(){return n.Promise.resolve(e.account().getSignedInAccountsAsJsonAsync().then(function(n){return e.accountList().getAvailableAccountsAsJsonAsync().then(function(e){var t=JSON.parse(n),r=t.accounts.reduce(function(e,n){return e[n.webaccountid]="signedIn",e},{}),i=JSON.parse(e);return t.accounts.slice(1).concat(i.accounts.filter(function(e){return!r[e.webaccountid]})).map(function(e){return f(e.idp,r[e.webaccountid]||"notSignedIn")(e)})})}))}}}function g(e){var r=[function(e){return n.Promise.resolve(e.ux().getAllVariablesAsync().then(function(e){return JSON.parse(e)||{}})).catch(function(e){n.logTelemetryEvent({eventType:"ClientError",name:"WebviewBoot encountered unexpected error when calling getAllVariablesAsync",type:"GetUxConfigPromiseError",details:"Error: "+JSON.stringify(n.toJsonable(e)),displayed:!1})})}(e),d(e),p(e)];return n.Promise.all(r).then(function(r){var i=r[0],o=r[1],c=r[2];void 0===i.applang&&n.logTelemetryEvent({eventType:"ClientError",name:"WebviewBoot received undefined app language",type:"UndefinedAppLang",details:"No app language returned from Interop client. uxConfigs: "+JSON.stringify(i),displayed:!1});var a="undefined"!=typeof offlineStrings;return(a?n.meImport("offlineUtilities"):n.Promise.resolve()).then(function(r){if(a){r||n.logTelemetryEvent({eventType:"ClientError",name:"WebviewBoot failed to render offlineUtilities under offline mode",type:"OfflineUtilitiesUnavailable",details:"offlineUtilities.js should be rendered together with offlineStrings.js and hence be available in offline mode",displayed:!1});var l=r&&r.ResolveCulture(i.applang)||u;n.setCurrentLang(l),n.addStrings(l,offlineStrings[l])}var d={theme:function(e){switch(e.apptheme){case"azure_hcdark":case"dark":return{type:"dark"};case"azure_hclight":case"light":case"custom":case void 0:case null:return{type:"light"}}n.assertNever(e.apptheme,"")}(i)},p=o[0],g=p?f(p.idp,"signedIn")(p):void 0,v={};return c.map(function(e){var n=f(e.idp,"notSignedIn")(e);v[t(n)]=e}),o.map(function(e){var n=f(e.idp,"signedIn")(e);v[t(n)]=e}),{options:{apiGeneration:"GEN2",containerId:s,authProviderConfig:m(e,0,v,i),primaryUXConfig:d,currentAccount:g},uxConfigs:i}})})}("undefined"!=typeof interopClient?n.Promise.resolve(interopClient):"function"==typeof URL&&"true"===new URL(window.location.href).searchParams.get("offline")||window.location.href.match(/\?*offline=true/i)?n.Promise.resolve({account:function(){return{getSignedInAccountsAsJsonAsync:function(){return n.Promise.resolve(JSON.stringify({accounts:[]}))},fireLaunchBrowserUriRequested:function(e){},fireAccountSignOutRequested:function(e,n){},fireAccountSelectedRequested:function(e,n){},fireAccountSelectionLegacyRequested:function(){},fireAddAccountRequested:function(e){},fireJSExecuted:function(e){},fireWebViewRendered:function(e){},fireEscapeWebViewRequested:function(){}}},accountList:function(){return{getAvailableAccountsAsJsonAsync:function(){return n.Promise.resolve(JSON.stringify({accounts:[]}))}}},ux:function(){return{getAllVariablesAsync:function(){var e={applang:"en-US",apptheme:"light",idps:"MSA | AAD",osver:l.toString()};return n.Promise.resolve(JSON.stringify(e))}}}}):n.Promise.reject(new Error("the interopClient object shall be present under production environment"))).then(function(e){return e.account().fireJSExecuted(!0),g(e).then(function(t){var r=t.options,i=t.uxConfigs;document.addEventListener("keydown",function(n){switch(n.key){case"Escape":case"Esc":n.preventDefault(),n.stopPropagation(),e.account().fireEscapeWebViewRequested()}}),window.MeControl.Loader.load(r),e.account().fireWebViewRendered(!0);var o=n.getOptions();o&&o.syntheticEventTarget.addEventListener("uriClickEvent",function(t){if(t.detail){t.detail.uriClickEvent.preventDefault();var r=new a(t.detail.uri,i.appname||"notavailable").constructJSONStr();e.account().fireLaunchBD\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|\uD83C\uDFF4\u200D\u2620)\uFE0F|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDF6\uD83C\uDDE6|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDBB\uDDD2-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              